#This code updates all publishers in the publishers collection. If the collection is empty, it will populate it with our 70 publishers. 
#If this code is run while the collection already has all of our publishers in it, it will just update the publishers, and shouldn't cause any duplicates.
#If you need to clear the entire collection, see the code at the very bottom of the file.
#Let me (Allegra) know if you have any questions before you try to run this.

import pymongo
from pymongo import MongoClient
from mongoengine import *
import requests

#connects to our MongoDB server running on MongoDB Atlas
#commented out for safety to prevent people who don't know how it works from running it, uncomment to actually run
# client = MongoClient("mongodb+srv://teama7:ee461lteama7@mongodbcluster.bs58o.gcp.mongodb.net/BGDB?retryWrites=true&w=majority")
# connect('BGDB', host='localhost', port=27017)

# designate 'db' as the name of our database to be used in this code and designate names of the collections to be used in this code
db = client["BGDB"]
boardgamecollection = db["boardgamecollection"]
genrecollection = db["genrecollection"]
publishercollection = db["publishercollection"]


##############################################TO POPULATE PUBLISHER COLLECTION WITH PUBLISHERS AND STARTER INFO##############################################################

listOfDicts = [{"Name": "Stronghold Games",
                "Description": "Founded in late 2009, the focus of Stronghold Games has been to provide maximum customer value by delivering high-quality products, and maximum customer satisfaction with Best of Breed games, i.e. games that are the finest in mechanic, theme, and/or other attributes valued by gamers."
                ,"Games":[], "Genres": [] },

               {"Name": "CMON", "Description": "When it started business, CMON Limited manufactured miniatures and miniature-related wargames. Over time, the company started publishing board games with a miniatures-related theme, such as Arcadia Quest, Blood Rage, and Zombicide. In 2015, CMON Limited escalated its game publication efforts, branching out into many different types of publications and partnering with publishers in Europe and Australia to release games in the North American market and elsewhere." ,"Games": [],"Genres": [] },

               {"Name": "Hasbro", "Description": "Hasbro, Inc. is an American multinational toy and board game company. It is one of the largest toy makers in the world. The corporate headquarters is located in Pawtucket, Rhode Island. The majority of its products are manufactured in East Asia. Over the years Hasbro has outsourced the manufacture of its products to third-party companies, mostly in China. A search of the US trademark database reveals that the first use of the word Hasbro as a brand was March, 1959. Unclear if that was for games or toys." ,"Games": [],"Genres": [] },

               {"Name": "Matagot", "Description": "Editions du Matagot is a leading boardgame company in France.They also currently publish three independant niche RPG lines: Cendres, Te Deum pour un Massacre and Metal Adventures. According to south-western French folklore, a matagot, or Silver Cat, is an evil spirit embodied in a black cat, that brings wealth to its owner if properly fed and kept. ","Games": [],"Genres": [] },

               {"Name": "Rio Grande Games", "Description": "Rio Grande Games is dedicated to bringing you the best in family entertainment. We offer the best family strategy games available! We have games for younger children to play with their older siblings and parents, games for their older siblings to play with their friends, and games for teens and parents to play with each other or when they get together for social occasions. We publish a large variety of our own games, but also import many multi-lingual games (in English, French, and, occasionally, other languages), that we feel could have a place in your homes.","Games": [],"Genres": [] },

               {"Name": "Gozer Games, LLC", "Description": " Gozer Games, LLC was founded in 2007 with the belief that games should be funny as well as fun. Gozer, the mascot of Gozer Games, is a chinchilla who in her spare time slays monkeys and leaves no piece of furniture uneaten.","Games": [],"Genres": [] },

               {"Name": "Space Cowboys", "Description": " Founded in March 2013, Space Cowboys is a brand new company/boardgame studio, but that much can't be said about its members, as the name may suggest. The Space Cowboys project originally stems from Marc Nunes, Philippe Mouret and Croc, Asmodee's three founding (grand)fathers. After 23 years, you could say they've fallen into a certain routine, which is why they wanted to go back to their origins — that is, designing and publishing games. But even with as much vigor as they still have, you need more than three geezers to get a rocket going! They therefore asked two young technicians to join them on their journey: Cyril Demaegd (Ystari) and Sebastien Pauchon (GameWorks). As both of them agreed to come aboard, in the end the Space Cowboys team consists of five members. The idea being to publish games we find cool, the range of styles from Space Cowboys might end up being quite large. The future will tell...","Games": [],"Genres": [] },

               {"Name": "Jolly Roger Games", "Description": "American publisher, founded in 1996","Games": [],"Genres": [] },

               {"Name": "Playroom Entertainment", "Description": " Founded in 2000, Playroom Entertainment was formed to promote the excitement that games have traditionally provided in new and creative ways. From strategy board games to zany card games to educational kids' games, Playroom has it all!","Games": [],"Genres": [] },

               {"Name": "Gamewright", "Description": "Based in Newton, Massachussetts, Gamewright was founded in 1994 by four parents whose kids wanted great games. From the start, our mission has remained clear: Create the highest quality family games with outstanding play-value. Guided by themes and experiences that transcend age and salted with a bit of irreverence, our games are designed to foster laughter, learning, friendship and fun. Over the years, our family has grown to over 50 games, 150 awards, and countless happy players. The thousands of letters we receive from kids, parents, grandparents, and teachers tell us our hearts are in the right place. Thank you for inviting us into your home and for playing with Gamewright! ","Games": [],"Genres": [] },
                    #LLC
               {"Name": "Darktier Studios", "Description": "Independent game publisher in Grand Rapids, MI specializing in Board Games, Card Games and Roleplaying Games. ","Games": [],"Genres": [] },

               {"Name": "Asmodee", "Description": "Asmodee: Entertaining everyone.Asmodee, we're always on the hunt for the best games you can play. Whether you're looking for a fun game for the family, an engaging conflict between friends, or a controversial and exciting face-off, Asmodee has something for you. From best-selling family games and hilarious party games to gorgeous hobby games, Asmodee and its partners set the standard for production and gameplay.Asmodee publishes many of its own games as well as distributing games for many different publishers in different countries. Many of our games have won prestigious awards, such as Dixit (Spiel des Jahres 2010), 7 Wonders (Kennerspiel des Jahres 2011) and many others popular games like Dice Town, Formula D, and Cyclades. Based in Guyancourt, France.","Games": [],"Genres": [] },
               # MOI

               {"Name": "PD-Verlag", "Description": " Independent German Game Publisher ","Games": [],"Genres": [] },

               {"Name": "Secret Hitler", "Description": " Famously titled after its only hit game, Secrete Hitler","Games": [],"Genres": [] },

               {"Name": "IELLO", "Description": "IELLO is a game and toy company founded in 2004 in France. We began solely as a distributor, but by 2008, we began partnering with many studios to publish games as well. In 2010, we began publishing under our own brand. We specialize in games that are rich with graphics, beautiful in design, and innovative in game play. We are now a premier publisher and worldwide distributor in a fast-expanding industry. In 2012, we solidified our position by creating a U.S. division to better service the American market. This, coupled with the release of Richard Garfield's best-selling and award-winning game King of Tokyo in 2011, put us in the forefront of international game companies. We believe in the ability of games to bring people together. To that end, our goal is to bring the world games that are irresistible: games that are intriguing enough to pick up and impossible to put down. From children's and family games, to party and card games, to strategy games of every variety, we want to provide games of high quality and immense replayability. So, from our game table to yours, enjoy! And game on! ","Games": [],"Genres": [] },

               {"Name": "Fantasy Flight Games", "Description": " Fantasy Flight started out as a publisher of European comics in the US. They weren't successful until they published the first edition of Twilight Imperium and have since grown to be the 5th largest publisher of boardgames in the world. They have in-house design, art, and development staff, but also are the US publishers of a variety of outside designs. They are known for their large quantities of quality components and flashy art style. ","Games": [],"Genres": [] },

               {"Name": "Brain Games", "Description": " Brain Games is a board game publisher and wholesaler in three Baltic states (Estonia, Latvia and Lithuania), as well as the United States. All of the games published by Brain Games feature language-independent components, with game rules in multiple languages, including: Estonian, Latvian, Lithuanian, Russian, English, French, and German. ","Games": [],"Genres": [] },
                #moi
               {"Name": "TwinbroGames", "Description": "A proudly single man publishing company working in the Seattle area ","Games": [],"Genres": [] },

               {"Name": "Serious Poulp", "Description": "Serious Poulp is a French board game publisher founded in 2010 by Ludovic Roudy and Bruno Sautter. They have designed Steam Torpedo, a tactical 2-player submarine battle game, with fun metagaming and exciting combos. Their second game, 8 Masters’ Revenge, is a martial arts game for 1 to 4 players, in which you must outwit your opponents to find the flaw in their defence and knock ’em out. Their next game “The 7th continent” is the first “choose-your-own-adventure” exploration and survival board game ","Games": [],"Genres": [] },

               {"Name": "Die-Hard Games LLC", "Description": "Die-Hard Games is a tabletop game developer and publisher. Acquired by Ragnarok Publications in 2017. Formerlu basin Gardner, Kansa ","Games": [],"Genres": [] },

               {"Name": "Gamelyn Games", "Description": "Gamelyn Games founded by Michael Coe and best known for their Tiny Epic games, delivers thought provoking, high quality, and affordable products with top-notch customer service. Gamelyn Games is an award winning game publishing company based out of Queen Creek, Arizona. Gamelyn Games, LLC was founded in 2012. Mission Statement: Our mission is to provide friends and family with memorable experiences through quality gaming. We believe that avant-garde games with stimulating challenges, thought provoking mechanics and approach-ability will provide gamers of all types a common ground to play on. ","Games": [],"Genres": [] },

               {"Name": "Grail Games", "Description": "Grail Games is a small publishing studio located in Sydney, Australia. Due to our size and distance from the gaming capitals of Western Europe and the USA, most of our games will be smaller - cheaper to produce and ship worldwide. This, of course, does not mean we skimp on quality. We are currently negotiating rights to a number of game reprints and hope to run a Kickstarter campaign for our first in-house production in the 3rd quarter of 2014. Our focus is on board and card games that address the following criteria: Family friendly - Games promote friendships and family fun. Grail Games are designed to be enjoyed by adults and older children at the same time. No mature themes or overly-complex narratives will be employed by our designers. Fast to teach - We believe that extremely complex games can be fun but are barriers of entry to non-gamers and family-gamers. We will only produce games with clean, straight-forward rules sets. Offer depth and replayability - Games can be simple and fast, but they will only blossom if they offer gamers a variety of strategies or different levels of depth to explore. We hope all our games will have a very high Depth to Box Size Ratio. ","Games": [],"Genres": [] },

               {"Name": "Wizards of the Coast", "Description": "Wizards of the Coast LLC, a subsidiary of Hasbro, Inc. (NASDAQ:HAS), is the leader in entertaining the lifestyle gamer. The company holds an exclusive patent on trading card games (TCGs) and their method of play and produces the premier trading card game, Magic: The Gathering, among many other trading card games and family card and board games. Wizards is also a leading publisher of roleplaying games, such as Dungeons & Dragons, and publisher of fantasy series fiction with numerous New York Times best-sellers. ","Games": [],"Genres": [] },

               {"Name": "Avalon Hill Games, Inc.", "Description": " Avalon Hill Games, Inc. is a game company that specializes in wargames and strategic board games. It has also occasionally published miniatures gaming rules. Its logo contains its initials AH (and sometimes HAH, for Hasbro Avalon Hill), and the company is often referred to by this abbreviation. Prior to its acquisition by Hasbro, AH had also published role-playing games and a popular line of sports simulations.","Games": [],"Genres": [] },

               {"Name": "R&D Games", "Description": "R&D Games was formed in 1989 by hobbyist Richard Breese, in order to publish largely his own designs. Richard is an accountant, and designs in his 'spare' time. Richard's sister Juliet was the illustrator on most of the R&D titles until 2016, with Vicki Dalton taking over from then. In recent years R&D Games have released a new title each year at the Essen Spiel, with wider distribution afterwards through co-publishers. ","Games": [],"Genres": [] },

               {"Name": "Game Salute", "Description": "Game Salute publishes games. We also provide a comprehensive platform for the creation, sales, and distribution of tabletop games for independent publishers. ","Games": [],"Genres": [] },

               {"Name": "KOSMOS", "Description": "Franckh-Kosmos Verlags-GmbH & Co. is a media publishing house based in Stuttgart, Germany, founded in 1822 by Johann Friedrich Franckh. In the nineteenth century, the company published the fairy tales of Wilhelm Hauff as well as works by Wilhelm Waiblinger and Eduard Mörike. The Friends of Nature Club (Gesellschaft der Naturfreunde) was set up in 1903 in response to booming public interest in science and technology, and by 1912 100,000 members were receiving its monthly magazine (Kosmos). The company moved into publishing books on popular science topics under the brands Franckh'sche Verlagshandlung and KOSMOS, including successful non-fiction guidebooks by Hanns Günther and Heinz Richter. ' \
                                                                                                                                                                                                                                                                                                                               ' Children's fiction and Kosmos-branded science experimentation kits were introduced in the 1920s.","Games": [],"Genres": [] },

               {"Name": "NSKN Games", "Description": "NSKN Games, which launched in 2011 with Warriors & Traders, consists of a team of creative people who want to introduce interesting, entertaining, one-of-a-kind strategy board games to the world. Notes the publisher: 'Our games are mostly influenced by a particular historical period or a special event. We strive to have individual graphical design for each of our games, and this is what makes their appearance one-of-a-kind on the market.' In November 2018, NSKN Games merged with publisher Board&Dice, keeping the Board&Dice name for the combined operation. ","Games": [],"Genres": [] },

               {"Name": "Bézier Games", "Description": "Bézier Games, Inc. makes strategy games and card games, including the top-ranked Ultimate Werewolf series, Suburbia, and many more games. Run by Ted and Toni Alspach, Bezier Games, Inc. has been around since 2007, with games published in several languages available around the world. Bezier Games, Inc. has had a booth at SPIEL since 2007 and can be found at many other trade shows in the U.S. each year. ","Games": [],"Genres": [] },

               {"Name": "Splotter Spellen", "Description": "Splotter is a small Dutch board game publisher, founded in 1997. We create board- and cardgames, mostly for a market of gaming enthusiasts. We are famous for making deep, complicated strategy games. The kind of games that can elicit reviews like this: I simply cannot wrap my head around how this game is supposed to work. I played with a couple guys who think it's amazing, but I can't keep track of things, and every time I thought I had a strategy it would all come toppling down at the first hint of interaction with other players. or, alternatively, this: If you take the best games ever, maybe you'd have #1 Puerto Rico, #2 El Grande or that stupid Catan game. Well, Roads & Boats is game #0 - the game that can never be beaten. We're just saying, these games are not for everyone. Plus, we try to make different games each time, and we normally put a twist on things that some people love and others hate. The good thing is, it allows us to make original and unique games that lots of people love. They are very expensive though, because of the small print runs. So play the games before you buy them, if you can. Splotter these days consist of two people, Jeroen Doumen and Joris Wiersinga. We both work in other companies during the day, and running Splotter is what we do nights and weekends. So, we may sometimes be a bit slow in responding to your questions and orders. But we do try to provide very good customer service and answer all of your questions. There used to be two more Splotters, Herman Haverkort and Tamara Jannink. They left the company to focus on their jobs and the rest of their lives again. We do have lots of other people collaborating and playtesting, and you are most welcome to join us at sessions, which take place in the Netherlands around Leiden, Rotterdam and Eindhoven. Otherwise, you can meet us every year at the tradefair SPIEL in Essen, Germany, in October. If you're reading this and you've never been there, drop all other plans and buy a ticket this year. It's worth it. ","Games": [],"Genres": [] },

               {"Name": "Czech Games Edition", "Description": "We are a group of people who love board games and enjoy creating entertainment for players like we are. Back in 2006, we worked together on the first edition of Through the Ages, and we decided that this is the work we wanted to do for a living. Founded in 2007, Czech Games Edition (CGE) released our first titles in Galaxy Trucker by Vlaada Chvátil and League of Six by Vladimír Suchý. Since then, CGE has published over 40 games and expansions, including Codenames, Alchemists, Dungeon Lords, Tzolk’in, Last Will, Space Alert, Dungeon Petz, Tash-Kalar and many others. In 2014, we expanded into the realm of digital board games with the implementation of Galaxy Trucker, followed by Through the Ages. Now, the digital team is working on the Through the Ages expansion and a digital version of Codenames. CGE introduced the complete novelty of our portfolio in 2017 when we published our first novel – Galaxy Trucker: Rocky Road by Jason A. Holt. The story takes place in the goofy Galaxy Trucker universe. Focused on publishing the games of Czech and Slovak authors such as Vlaada Chvátil, Vladimír Suchý, and Matúš Kotry, we have also cooperated with authors from Croatia (Filip Neduk), Italy (Daniele Tascini, Simone Luciani), Hungary (Dávid Turczi), and the US (Scot Eaton). We are a small company, but thanks to our partners around the world, you will find our games in over forty languages. ","Games": [],"Genres": [] },

               {"Name": "Gen42 Games", "Description": "From the publisher's website: Started in 2002 'Gen42 Games' is the London based games company of John Yianni the inventor of the much renowned and award winning 'Hive' game. Committed to bringing back the sense of excitement and adventure we all felt when playing games as kids, John designs games that he himself loves to play, and has an ambition of introducing these games to people who want to feel that sense of excitement and adventure again. John loved to design and make games from a young age which he played with family and friends. It was not until he came up with the idea for the amazing 'Hive' game, that he then started 'Gen42 Games' and took his passion to another level. 'Gen42 Games' has now become an international company with 'Hive' becoming a world wide mania. We at 'Gen42 Games' pride ourselves in the quality of our games, both in the materials we use and the quality of the game play. We also pride ourselves in bringing the best possible customer service. Though 'Gen42 Games' is one of the smaller breed of games companies, we have big and exciting plans for the future, all fuelled by fantastic games. ","Games": [],"Genres": [] },

               {"Name": "Indie Boards & Cards", "Description": "Indie Boards & Cards is open for submissions - if you have a game that has been play tested, plays 2-5 players in under an hour send me an email at contact@indieboardsandcards.com. If you have any issues, please send an email to contact@indieboardsandcards.com. If you have any Kickstarter issues, please send an email to kickstarter@indieboardsandcards.com. ","Games": [],"Genres": [] },

               {"Name": "Renegade Game Studios", "Description": "Renegade Game Studios was founded in 2014 by Scott Gaeta, founder & former COO of Cryptozoic Entertainment. Gaeta's goal with Renegade is to produce the highest quality hobby board games that both new and current gamers will love. Mission To publish games that are fun, challenging, and unique. We believe that gaming is for everybody and that everybody is a gamer; you may have just not found that right game yet! ","Games": [],"Genres": [] },

               {"Name": "Arcane Wonders", "Description": " Arcane Wonders publishes strategic, competitive, and social board & card games to enjoy with your friends. Since 2012, Arcane Wonders has released many award winning games, including best-selling Mage Wars Arena and Mage Wars Academy games, the renowned 2015 Origins Award Winning bluffing game, Sheriff of Nottingham, and UK Games Expo 2016 Best Abstract winner: Onitama. Arcane Wonders also publishes the The Dice Tower Essentials® line of games, in partnership with noted reviewer, Tom Vasel, of The Dice Tower. These are games that Tom himself has played, loves, and brought to Arcane Wonders to publish under this exclusive product line. Partnering with Tom, Arcane Wonders® is building a library that will consist of everything from brand new games from first-time designers to existing games from experienced designers which have not seen the full exposure they deserve. ","Games": [],"Genres": [] },

               {"Name": "Plan B Games", "Description": "Driven by a never-ending passion and benefiting from numerous years of experience in the board game industry, the team at Plan B Games wants to do things differently by offering players remarkable gaming experiences. This new publisher launched its first game, Century, in June 2017. Studios within Plan B Games are Next Move Games and Pretzel Games Eggertspiel.com is connected to Plan B Games, @2018 Plan B Games Europe GmBH. All Rights Reserved. ","Games": [],"Genres": [] },

               {"Name": "Asmodee Editions", "Description": " No information Available","Games": [],"Genres": [] },

               {"Name": "Lookout Games", "Description": "No information Available ","Games": [],"Genres": [] },

               {"Name": "Grey Fox Games", "Description": " Grey Fox Games is a publishing and fulfillment/distribution company for high quality board games. A note from the company about what it does: We are a publishing, marketing and fulfillment company that has made a diverse group of accessible, thematic games you’ll love to get to the table! From our hit worker placement title Champions of Midgard to social deduction staple Deception: Murder in Hong Kong or the family friendly Harvest Dice, Grey Fox Games has a title for gamers of all stripes. We carefully select and develop each game in our line to make sure it lives up to our high standards of playability and fun. Grey Fox Games is quality games, cleverly crafted.","Games": [],"Genres": [] },

               {"Name": "Alderac Entertainment Group", "Description": "Alderac Entertainment Group, or AEG, is a publisher of role-playing game and collectible card game products. AEG was formed in 1993 and is based in the city of Ontario, California. Prior to getting into their current markets, AEG was involved in hobby gaming magazines, with their first product the magazine Shadis (winner of the 1994, 1995, and 1996 Origins Awards for Best Professional Gaming Magazine). AEG published Legend of the Five Rings and its associated CCG and RPG lines for 15 years. Including the three for Shadis mentioned above, AEG products have garnered eight Origins Awards. In 2009, AEG entered the board games market with 10 new board game releases. Thunderstone was a notable success from that wave of releases. Nightfall, an aggressive head-to-head deckbuilding game debuted in 2011, featuring the chaining mechanic developed with help from BGG users. In 2012, AEG published a widely praised revision of Thunderstone known as Thunderstone Advance. Later in that year, they published Smash Up, the shufflebuilding card game, and a new line of euro games set in the shared world of Tempest -- Dominare, Mercante, and Courtier. ","Games": [],"Genres": [] },

               {"Name": "Pandasaurus Games", "Description": " Pandasaurus Games was founded in 2012 in Austin, TX by Molly Wardlaw and Nathan McNair with the goal of making fun, accessible family-friendly hobby games. Statement To create games that allow for friends and family to gather and create lasting memories of the shared experience of fun!","Games": [],"Genres": [] },

               {"Name": "WizKids", "Description": "WizKids was founded in 2000 by Jordan Weisman, previously of FASA, to publish Mage Knight. Mage Knight was the first collectible miniatures game. The pieces incorporated a dial in the base that showed each piece's statistics. Those statistics changed as the piece took damage. Early employees joining Jordan in this endevor were his wife Dawne, who led the company's graphic design; his father Mort, who ran international sales; his brother-in-law Ray, who ran domestic sales; and Jenny (Trisko) Berg, previously of Bungie, who was in charge of marketing. In 2001 the company went from being virtuaL to having its own office in Bellevue, WA. Employees had previously been spread through Washington, Illinois, and Missouri. Mage Knight was selling as fast as it could be made, and the company moved into the hobby's list of 10 largest publishers. The employee count went up to over 30, including Don Gorski, COO; Tom Virgin, CFO; and Martin A. Stever, Executive V.P. ","Games": [],"Genres": [] },

               {"Name": "Ceaco", "Description": "No information available ","Games": [],"Genres": [] },

               {"Name": "GMT Games", "Description": "GMT Games is a publisher of strategy games, wargames, and eurogames since 1990, headquartered in Hanford, CA ","Games": [],"Genres": [] },

               {"Name": "Z-Man Games, Inc.", "Description": "At Z-Man Games, we create innovative games that become modern essentials. Since 1999, our studio has published a variety of critically acclaimed titles from casual to complex, cooperative to competitive, small bag to big box—and everything in between. We combine our keen eye for design, attention to aesthetics, and top-notch components to create the best games for every gamer. As an industry leader, we strive to support and grow the tabletop gaming community through novel gaming experiences. Check out our bestselling titles like Pandemic, Love Letter, Citadels, and Carcassonne, or participate in the first cooperative tournament in tabletop gaming, Pandemic Survival. No matter your gaming style, there’s a game in our catalog to fit your kind of fun.","Games": [],"Genres": [] },

               {"Name": "Libellud", "Description": "No information available ","Games": [],"Genres": [] },

               {"Name": "ABACUSSPIELE", "Description": "ABACUSSPIELE Verlag was founded in 1989 and is based in Dreieich near Frankfurt. In this family-run company, a committed team of employees has been working with great passion ever since. The main focus is on easily accessible, clever family and card games. We want to bring the whole family to the game table. Playing is not only something for children, it is a shared experience, in which everyone should participate, says Managing Director Joe Nikisch, his greatest concern. ABACUSSPIELE sets the highest quality standards in production. That's why the games are produced almost exclusively in Germany. Plastic parts are rarely used as playing materials. Instead, high-quality wooden parts and cardboard boxes from sustainable production are used. In addition to numerous awards, the title Game of the Year 2007 stands out for the game Zooloretto as the greatest success of the publishing history. Internationally, the publisher's products are also gaining more and more attention, and individual games have now been launched in over ten different language versions. In 2013 the publishing house continued its success story with the extraordinary game Hanabi. ABACUSSPIELE celebrated the first award of a card game as game of the year true to the motto: small games quite LARGE! ","Games": [],"Genres": [] },

               {"Name": "Portal Games", "Description": "Portal Games - Board games That Tell Stories. We are a board game publishing company founded in 1999 and based in Knurów, Poland. We are bookworms. Movie maniacs. RPG players. Story addicts…We grew up reading Tolkien, Howard, Herbert, Dick, Lem, Pratchett… We were watching Willow, Blade Runner, Never Ending Story, Robin Hood… and yet, we don’t write books… we don’t make movies. We don’t make those things, because we make games. We make games that tell stories.Books and movies are an amazing escape that can take us to different worlds. They fuel our imagination and dreams. They let us walk in the shoes of great heroes and have exciting adventures. With games, however, we can go further. We can experience these stories together with our friends. Gather around a table and fight enemies together. Survive or die as a group. Together, we can tell stories.This is what we do. This is what we believe in. Do you want to defend a castle? Do you want to build an Empire? Survive on deserted Island? Call your friends, sit at the table and get ready for the amazing story you will tell this evening. ","Games": [],"Genres": [] },

               {"Name": "Thames & Kosmos", "Description": "Franckh-Kosmos Verlags-GmbH & Co. is a media publishing house based in Stuttgart, Germany, founded in 1822 by Johann Friedrich Franckh. In the nineteenth century, the company published the fairy tales of Wilhelm Hauff as well as works by Wilhelm Waiblinger and Eduard Mörike. The Friends of Nature Club (Gesellschaft der Naturfreunde) was set up in 1903 in response to booming public interest in science and technology, and by 1912 100,000 members were receiving its monthly magazine Cosmos (Kosmos). The company moved into publishing books on popular science topics under the brands Franckh'sche Verlagshandlung and KOSMOS, including successful non-fiction guidebooks by Hanns Günther and Heinz Richter. Children's fiction and Kosmos-branded science experimentation kits were introduced in the 1920s ","Games": [],"Genres": [] },

               {"Name": "Days of Wonder", "Description": "Days of Wonder publishes top-quality, family-oriented board games that are easy to learn and fun to play. Our name is derived from the sense of wonder we all experienced as children when we first fell in love with playing games. Founded in 2002, Days of Wonder has a global presence, wth offices in the US and Europe, and distribution in 25 countries. In 2004, Days of Wonder became the youngest publisher ever to win Germany's prestigious Spiel des Jahres, the world's most coveted game prize, with the launch of its best-selling Ticket to Ride board game series. ","Games": [],"Genres": [] },

               {"Name": "Garphill Games", "Description": "Garphill Games (gar-fill) was established in 2007 by New Zealand designer, Shem Phillips. Shem always aims to produce quality games, with a strong focus on theme and design. Garphill Games is based out of Waikanae, New Zealand. ","Games": [],"Genres": [] },

               {"Name": "Tasty Minstrel Games", "Description": " Tasty Minstrel Games (TMG) is the culmination of a life long dream of founder and CEO Michael Mindes. When he was young, he loved everything that had to do with gaming. As he got older, that passion only increased. After attending college, he had every intention of becoming a board game publisher, but, as he has said, life happens, and his publishing pursuits were put on hold while he worked as a financial advisor with his father. He enjoyed his work, and was quite successful at it, but the dreams of making and publishing boardgames were still part of his long term goals. In 2009, Michael and good friend Seth Jaffee had two games they were ready to publish - Terra Prime (a design from Seth himself) and Homesteaders. Both of these games were well received by the community, and TMG was on its way. In the following years, TMG published such hits as Belfort, Dungeon Roll, and Seth Jaffee’s Eminent Domain. While at Spiel one year held in Essen, Michael played Orléans and knew that he had to publish it for the U.S. market. It was that game that was the first to be given the Deluxified treatment by TMG, something that has continued with other titles. Some of the games that TMG has published are older games that were in need of reprints, and discovering games in smaller markets that may not otherwise have seen a wider release. They were also one of the very first companies to use crowdfunding as a way to successfully publish their releases, helping starting a trend that is now commonplace within the industry today. Today, TMG has several full time employees, and while the home office is based in Utah, several of those employees work remotely from other locations. However, they all share the same goal - publishing awesome games that promote and facilitate enjoyment between family and friends. ","Games": [],"Genres": [] },

               {"Name": "Floodgate Games", "Description": "No page exist for this at this time. ","Games": [],"Genres": [] },

               {"Name": "Plaid Hat Games", "Description": "Plaid Hat Games LLC is a hobby gaming company founded by game designer Colby Dauch. Our goal as a game company is simple: Make games that you will love to play. And by you we mean those of you who play games to have FUN, to ENGAGE others, and to CHALLENGE yourself. (If you are one of those dreadfully boring types that hate the sound of dice rolling across a table and prefer their games to only come in shades of brown, we´re probably not what you are looking for.) So how will we achieve our goal of making games that you love to play? Well, I´m glad I asked that question. We have a formula, and I´d like to share it with you. ","Games": [],"Genres": [] },

               {"Name": "North Star Games", "Description": " North Star Games was originally founded in 2003 by pro Magic player Dominic Crapuchettes to bring innovation to a stagnant party game market. The success of Wits & Wagers and Say Anything in the hobby and mass markets enabled North Star Games to return to their gamer roots and create a hobby game division. Notable hobby games include the acclaimed Evolution series and The Quacks of Quedlinburg, winner of a 2018 Spiel des Jahres award. ","Games": [],"Genres": [] },

               {"Name": "Blue Cocker Games", "Description": " Few words :What makes a good game is the emotions you feel while playing,i.e. the game play.This is more about the gameplay that I intend to dwell! Gamplay, pointing to me evocations, emotions and various pleasures that the game attempts to mislead.Ok, things like depends mainly on players around the table, the time, and many other details,but still, the game , by these mechanisms, its theme and editorial treatment may make it easier or rather complex.For example, to speak of junk, Age of Steam is for me a great party game ! (i know , we re very few to think that !)The spread of this very personal truth has not been helped by his edition!So, I look for games with high natural gameplay and I will, in any case try to, magnify the gameplay by my editorial work. ","Games": [],"Genres": [] },

               {"Name": "Karma Games", "Description": "Karma Games was founded by Juma Al-JouJou in Berlin/Germany and publishes strategy board games. ","Games": [],"Genres": [] },

               {"Name": "White Wizard Games", "Description": "White Wizard Games LLC, is a company created by Magic: The Gathering Hall of Famers Darwin Kastle and Rob Dougherty (developer and co-founder of Ascension: Deckbuilding Game). The company is based out of Massachusetts. ","Games": [],"Genres": [] },

               {"Name": "Blue Orange Games", "Description": "At Blue Orange Games, we believe the simple pleasure that comes from sharing good times with friends and family around a great game to be very precious. Creating, publishing and promoting quality games is our way of sharing and furthering that belief. We would like to thank all the retailers and players around the world who support our games and make the pleasures of play an everyday reality. In June 2013, French publisher Jactalea announced a partnership with U.S. publisher Blue Orange Games and consequently a name change from Jactalea to Blue Orange, with BGG adding the parenthetical (EU) to distinguish one company from the other since Blue Orange's Timothee Leroy notes that while some games will be released by both publishers, other titles will be released by only the U.S. or the European division of Blue Orange. ","Games": [],"Genres": [] },

               {"Name": "Eggertspiele", "Description": "This publishing company was founded in 1996 and it is based in Hamburg, Germany. Its specialties are strategic and tactical games, translated in more than 20 languages and distributed all over the world  eggertspiele.com is connected to Plan B games, @2018 Plan B Games Europe GmBH. All Rights Reserved. ","Games": [],"Genres": [] },

               {"Name": "Spin Master", "Description": "Roxley Games Microbadge: Roxley Games fan is a game development and publishing firm located in Calgary, AB featuring some of the best game designers and artists the industry has to offer. Twitter: @roxleygames Facebook: facebSpin Master was founded in 1994 by two childhood friends, Ronnen Harary and Anton Rabie, soon after graduation from The University of Western Ontario. Ben Varadi, a classmate of Anton's from The University of Western Ontario's Richard Ivey School of business, joined the Company subsequently in 1994. The nascent entrepreneurs' first product was the Earth Buddy, a nylon stocking-covered head of sawdust topped with grass seeds which grew to emulate hair, funded with their own $10,000 investment. With Anton selling the item on the street and to specialty retailers, the operation quickly expanded to a small facility in downtown Toronto. This initial success served as the springboard for Spin Master's entry into the toy business. Spin Master has achieved significant growth over the past two decades, transforming itself from a small, single product toy company into a leading global, diversified, multi-platform and highly innovative children's entertainment company. The business has progressed through key stages, from start up growth, building the base, Bakugan growth, refocusing to diversified growth; operating now across all toy industry super categories. In 1998, Spin Master launched its Air Hogs brand, the first products designed to be easily flown by children and required limited assembly. The brand came to the company from two British inventors based on an innovative design involving a miniature engine powered by compressed air. It has come to represent affordable, technologically-advanced and innovative vehicles and aircrafts with hobby-grade remote control performance, designed and priced for the mass market. From 2002 - 2007, Spin Master expanded its international footprint, establishing sales and distribution offices across western Europe. The company also opened its Los Angeles marketing and design hub, allowing the company to access deep local toy design, marketing and engineering talent. During this time of growth, Spin Master made its first significant acquisition, acquiring X-Concepts, Inc, maker of Tech Deck. This growth allowed expansion of the company's licensing capabilities and relationships with major entertainment companies. In late 2007, Spin Master launched the most successful product in its history, Bakugan. The Bakugan brand started out as an inventor's sketch of a ball that could be opened up to reveal a character inside. The brand immediately attracted a large following among five to ten year old boys and the richness of the Bakugan characters, story and game play provided Spin Master the opportunity to extend the brand with the co-development of a global animated television series. This succes resulted in taking the technology to a girls property called Zoobles, achieve significant associated third-party merchandising revenue and further expand its operations. But as Bakugan approached the end of its product life cycle and the company experienced a significant decline in sales it needed to take swift action to right size the business, reorganize and reduce operating risk. The roles of its founders were refined and the company strategically complimented its executive management team with the addition of executives, including a new Global President and Chief Operating Officer, Ben Gadbois. These swift actions put Spin Master back on course for growth. Today, the company has resumed its history of growth, with a renewed focus on diversification and increased operational and financial discipline. It has expanded into a number of new toy categories, organically and through acquisitions. The company's acquisition of Spy Gear expanded the company's offering in boys action and outdoor toys, The acquisition of Meccano provided an entry into the building sets category and the acquisition of Cardinal Games has made Spin Master the #2 manufacturer in the games & puzzles category in North America. Spin Master has since made a number of key acquisitions including EG Games, Etch A Sketch, Toca Boca/Sago Mini, Swimways, Marbles, Aerobie, Perplexus and most recently GUND. In July 2015, Spin Master completed its public offering and began trading on the Toronto Stock Exchange. Since 2000, Spin Master has received 103 TIA Toy of The Year (TOTY) nominations with 28 wins across a variety of product categories, including 13 TOTY nominations for Innovative Toy of the Year, more than any of its competitors. The company's continued investment and support of its entertainment division has also yielded meaningful results. To date, Spin Master has produced six television series, including 2007 success, Bakugan Battle Brawlers, and current hit PAW Patrol, which is broadcast in over 160 countries and territories globally. When Spin Master began to chart it's course in the children's entertainment industry, the founders recognized that in order to compete successfully with the established brands of larger companies, they had to design and market innovative products that would wow consumers and disrupt the traditional toy market. With the inspiration of its founders, who remain actively engaged in the business today Spin Master has maintained a deeply rooted culture of creativity, partnership and passion. ","Games": [],"Genres": [] },

               {"Name": "Roxley", "Description": "Roxley Games Microbadge: Roxley Games fan is a game development and publishing firm located in Calgary, AB featuring some of the best game designers and artists the industry has to offer. Twitter: @roxleygames Facebook: facebook.com/roxleygames Email: games@roxley.com Web: roxley.com. At Roxley, we develop games with the intention of bringing the following core fundamentals to the table: Innovative Whether it’s a new mechanism, a new theme, or both, Roxley Games requires that every one of our projects features some sort of innovation. I mean, we wouldn’t be able to call ourselves a laboratory otherwise, would we? Addictive At Roxley, it is our deep dark secret to one day create a boardgame so addictive that governments all over the world have no choice but to pass legislation to limit how often people are allowed to play it. Beautiful How a game looks has a huge impact on how the game feels when you play it. That’s why our games feature amazing illustrations, intuitive iconography, and polished graphic design all created by industry leading artists and graphic designers. Robust How a game feels is as important to us as how it looks. Game components should feel robust and high quality. We take great care in selecting the proper component for every game mechanism to alleviate fiddliness. Our manufacturers are some of the best in the entire world. Polished Game development is all about testing, testing, testing… and when you are done all that testing, you test some more. Roxley Games run a gammut of playtesting with game designers and blind playtesters to ensure they are well balanced and polished. Our “gamer’s” games can be in heavy development for multiple years. Replayable Hobby boardgames are not cheap to produce, and they certainly aren’t cheap to buy. We want our games to have a permanent spot on your shelf. Games that you can come back to again and again. That is why we strive to ensure that all of our games are highly replayable featuring different setups and story lines every time you play.","Games": [],"Genres": [] },

               {"Name": "Ravensburger", "Description": "Though people tend to think of us as a puzzle company, we like to think of ourselves as so much more. In addition to being a leading supplier of puzzles, games and other products around the world as well as children’s books in Germany, Ravensburger is also a leading provider of jobs in Europe. The blue triangle is one of the most famous trademarks in Germany. The product range includes about 8,000 different products (including all country-specific items) sold worldwide, 85% of which we make ourselves.Ravensburger has approximately 1,471 employees and generated consolidated sales of € 311.7 million in 2010. That same year, we broke into the Guinness Book of World Records with our 32,256 piece puzzle, Keith Haring: Double Retrospect. We may be known today around the world as a premier puzzle company, but the Ravensburger name is backed by over a century of experience in the family entertainment and education spheres. ","Games": [],"Genres": [] },

               {"Name": "Hans im Glück", "Description": " No Description available","Games": [],"Genres": [] },

               {"Name": "Repos Production", "Description": "Repos Production is a European board game publisher, Belgian to be precise, having started its activity by importing Time's Up!. This success has allowed them to develop a range of original games of which 7 Wonders is the illustrious representative. ","Games": [],"Genres": [] },

               {"Name": "Greater Than Games", "Description": "Founded in January 2011 by Christopher Badell, Adam Rebottaro, and Paul Bender, Greater Than Games, LLC designs and publishes tabletop gaming products. We here at Greater Than Games are all about making the games that we have always wanted to play. Greater Than Games and Dice Hate Me Games merged in 2015, with the combined company using three brands — Sentinel Comics Games, Fabled Nexus Games, and Dice Hate Me Games — to identify the games that it released. That approach changed in 2018 with the first two brands being merged again into a single Greater Than Games brand and the latter brand being renamed Dice Hate Me Studio. ","Games": [],"Genres": [] },

               {"Name": "Next Move Games", "Description": " Next Move Games focuses on LITE themed abstract games with DEEP strategy. Next Move Games will bring fans PURE games with simple, CORE mechanisms to engage their minds. Fans can expect CHIC, high-quality components that offer a simple pleasure to the tactile and visual senses. A final point to note is that Next Move titles will be FOUR letters in length to reinforce the elegance in the game's design. Next Move Games is a publishing and design studio owned by Plan B Games.","Games": [],"Genres": [] },

               {"Name": "Stonemaier Games", "Description": " Stonemaier Games is a tabletop game publisher run by Jamey Stegmaier with the support of co-founder Alan Stone, Director of Communications Joe Aubrey, Director of Sales Alex Schmidt, and a myriad of talented independent contractors, volunteers, and fans. Based in St. Louis and distributed worldwide, Stonemaier Games’ brands include Viticulture, Euphoria, Between Two Cities, Scythe, Charterstone, My Little Scythe, Between Two Castles of Mad King Ludwig, Wingspan, Tapestry, and Pendulum. Mission Statement: We strive to create memorable, beautiful, fun games that engage and delight gamers worldwide. We aim for games that capture the imaginations of all types of people, as our goal is to include, not exclude: experienced gamers, new gamers, solo gamers, partners, larger groups, people of all races, genders, creeds, cultures, nations, sexualities, and ages. We also seek to add value to our fellow creators in a way that extends beyond board games by sharing our entrepreneurial successes, mistakes, and insights. ","Games": [],"Genres": [] },

               {"Name": "Leder Games", "Description": "Leder Games is a small but quickly growing company from Saint Paul Minnesota. Leder Games is taking a studio approach to design. They are the makers of the Vast series and Root. ","Games": [],"Genres": [] },

               {"Name": "Cephalofair Games", "Description": "Cephalofair Games is a small board game design and publishing company founded by Isaac Childres in Lafayette, IN. They specialize in thematic Euro-style game play. ","Games": [],"Genres": [] }]



for i in range(len(listOfDicts)):
    Dict = listOfDicts[i]
    publishercollection.replace_one({'Name': Dict['Name']}, Dict, upsert=True)


###############################TO COLLECT ALL GAMES AND GENRES ASSOCIATED WITH EACH PUBLISHER######################################

for game in boardgamecollection.find():
  publisher = game["Publisher"]
  publishercollection.update_one({'Name': publisher}, {"$addToSet" : {"Games": game['Name']}})

for genre in genrecollection.find():
  for publisher in genre['Publishers']:
    publishercollection.update_one({'Name': publisher}, {"$addToSet" : {"Genres": genre['Name']}})


################################TO POPULATE INFORMATION FOR ALL PUBLISHERS IN COLLECTION######################################

for publisher in publishercollection.find():

	################################TO CALCULATE AVERAGE PLAYERS, PLAYTIME, AND PRICE######################################

	totalminplayers = 0
	totalmaxplayers = 0
	totalplaytime = 0
	gamecount = 0
	totalprice = 0
	gameswithpricecount = 0

	for gamename in publisher["Games"]:
		game = boardgamecollection.find_one({"Name": gamename})
		totalminplayers += game["Min_Players"]
		totalmaxplayers += game["Max_Players"]
		gameaverageplaytime = game["Min_Playtime"]
		gameaverageplaytime += game["Max_Playtime"]
		gameaverageplaytime = gameaverageplaytime/2
		totalplaytime += gameaverageplaytime
		gamecount += 1
	if float(game["Current_Price"]) != 0:
		totalprice += float(game["Current_Price"])
		gameswithpricecount += 1

	averageminplayers = totalminplayers / gamecount
	averagemaxplayers = totalmaxplayers / gamecount
	averageplaytime = totalplaytime / gamecount
	if(gameswithpricecount != 0):
		averageprice = totalprice / gameswithpricecount
		publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Price": "%.2f" % averageprice}})
		publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Price_Float": round(averageprice, 2)}})
	else:
		averageprice = "Not Available"
		publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Price": averageprice}})

	publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Min_Players": round(averageminplayers)}})
	publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Max_Players": round(averagemaxplayers)}})
	publishercollection.update_one({'Name': publisher['Name']}, {"$set" : {"Average_Playtime": round(averageplaytime)}})


	#####################################TO FIND IMAGES TO USE ON THE PUBLISHER INSTANCE PAGES############################################

	#API request from Google Images
	#uses API key generated on GCP to search custom search engine (also generated in GCP) that only searches Board Game Geek and Wikipedia
	#safe search is on and results return exactly one image

    name = publisher["Name"]
    searchname = publisher['Name'].replace(" ", "+") + "+board+game+publisher+logo"
    requeststring = "https://www.googleapis.com/customsearch/v1?key=AIzaSyCxFCh2XeiGTNT7kjDN2fhfB_J3W0ByabY&cx=4366fe0d278a82053&num=1&searchType=image&imgSize=medium&q=" + searchname
    resp = requests.get(requeststring)
    if resp.status_code != 200:
        # This means something went wrong.
        raise ApiError('GET /tasks/ {}'.format(resp.status_code))
    else:
        results = resp.json()['items']
        formattedresults = results[0]
        image_url = formattedresults['link']
        publishercollection.update_one({'Name': name}, { "$set" : {"Image_URL": image_url}})


######################################################CLEAR COLLECTION#############################################################

#If for some reason you need to delete the collection entirely, comment out everything in this file besides the code below, then run.

#client = MongoClient("mongodb+srv://teama7:ee461lteama7@mongodbcluster.bs58o.gcp.mongodb.net/BGDB?retryWrites=true&w=majority")
#connect('BGDB', host='localhost', port=27017)

#db = client["BGDB"]
#publishercollection = db["publishercollection"]
#publishercollection.delete_many({})

